<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>eqsql.task_queues.service_queue module &#8212; EQ-SQL  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css?v=ad52900a" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=fd6eb6e6"></script>
    <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="eqsql.task_queues.emews_service module" href="eqsql.task_queues.emews_service.html" />
    <link rel="prev" title="eqsql.task_queues.gc_queue module" href="eqsql.task_queues.gc_queue.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="eqsql.task_queues.emews_service.html" title="eqsql.task_queues.emews_service module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="eqsql.task_queues.gc_queue.html" title="eqsql.task_queues.gc_queue module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">EQ-SQL  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="eqsql.html" accesskey="U">eqsql package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">eqsql.task_queues.service_queue module</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-eqsql.task_queues.service_queue">
<span id="eqsql-task-queues-service-queue-module"></span><h1>eqsql.task_queues.service_queue module<a class="headerlink" href="#module-eqsql.task_queues.service_queue" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="eqsql.task_queues.service_queue.ServiceTaskQueue">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">eqsql.task_queues.service_queue.</span></span><span class="sig-name descname"><span class="pre">ServiceTaskQueue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">service_url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eqsql.task_queues.service_queue.ServiceTaskQueue" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Task queue protocol for submitting, manipulating and
retrieving tasks</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>service_url</strong> (<em>str</em>)</p></li>
<li><p><strong>db_params</strong> (<em>DBParameters</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="eqsql.task_queues.service_queue.ServiceTaskQueue.are_queues_empty">
<span class="sig-name descname"><span class="pre">are_queues_empty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eq_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.are_queues_empty" title="Link to this definition">¶</a></dt>
<dd><p>Returns whether or not either of the input or output queues are empty,
optionally of a specified task type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>eq_type</strong> (<em>int</em>) – the optional task type to check for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the queues are empty, otherwise False.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eqsql.task_queues.service_queue.ServiceTaskQueue.as_completed">
<span class="sig-name descname"><span class="pre">as_completed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">futures</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sleep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.as_completed" title="Link to this definition">¶</a></dt>
<dd><p>Returns a generator over the <code class="xref py py-class docutils literal notranslate"><span class="pre">Futures</span></code> in the <code class="docutils literal notranslate"><span class="pre">futures</span></code> argument that yields
Futures as they complete. The  <code class="xref py py-class docutils literal notranslate"><span class="pre">Futures</span></code> are checked for completion by iterating over all of the
ones that have not yet completed and checking for a result. At the end of each iteration, the
<code class="docutils literal notranslate"><span class="pre">timeout</span></code> is checked. Note that adding or removing <code class="xref py py-class docutils literal notranslate"><span class="pre">Futures</span></code>
to or from the <code class="docutils literal notranslate"><span class="pre">futures</span></code> argument List while iterating may have no effect on this call.
A <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeoutError</span></code> will be raised if the futures do not complete within the specified <code class="docutils literal notranslate"><span class="pre">timeout</span></code> duration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>futures</strong> (<em>List</em><em>[</em><a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.Future" title="eqsql.task_queues.core.Future"><em>Future</em></a><em>]</em>) – the List of  <code class="xref py py-class docutils literal notranslate"><span class="pre">Futures</span></code> to iterate over and return as they complete.</p></li>
<li><p><strong>pop</strong> (<em>bool</em>) – if true, completed futures will be popped off of the futures argument List.</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – if the time taken for futures to completed is greater than this value, then
raise <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeoutError</span></code>.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – yield this many completed Futures and then stop iteration.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – retrieve this many completed futures, before yielding. Assuming a batch_size &gt; 1,
the remotely executing code will retrieve this many results before returning them to the
locally executing code. Consequently, this greatly reduces communication overhead, and
can improve the performance of a remote queue.</p></li>
<li><p><strong>sleep</strong> (<em>float</em>) – the time, in seconds, to sleep between each iteration over all the Futures.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Generator</em>[<a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.Future" title="eqsql.task_queues.core.Future"><em>Future</em></a>, None, None]</p>
</dd>
</dl>
<p>Yields:
<code class="xref py py-class docutils literal notranslate"><span class="pre">Futures</span></code> in the <code class="docutils literal notranslate"><span class="pre">futures</span></code> argument as they complete.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">futures</span> <span class="o">=</span> <span class="p">[]</span>
<span class="go">    // submit some tasks and append the Future instances to futures</span>
<span class="go">    for ft in task_queue.as_completed(futures, timeout=5):</span>
<span class="go">        status, result = ft.result()</span>
<span class="go">        // do something with result</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eqsql.task_queues.service_queue.ServiceTaskQueue.cancel_tasks">
<span class="sig-name descname"><span class="pre">cancel_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">futures</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.cancel_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Cancels the specified <code class="xref py py-class docutils literal notranslate"><span class="pre">Futures</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>futures</strong> (<em>List</em><em>[</em><a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.Future" title="eqsql.task_queues.core.Future"><em>Future</em></a><em>]</em>) – the <code class="xref py py-class docutils literal notranslate"><span class="pre">Futures</span></code> to cancel.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the <code class="xref py py-class docutils literal notranslate"><span class="pre">ResultStatus</span></code> and the ids of the successfully canceled tasks.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.ResultStatus" title="eqsql.task_queues.core.ResultStatus"><em>ResultStatus</em></a>, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eqsql.task_queues.service_queue.ServiceTaskQueue.get_priorities">
<span class="sig-name descname"><span class="pre">get_priorities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">futures</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.get_priorities" title="Link to this definition">¶</a></dt>
<dd><p>Gets the priorities of the specified tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>futures</strong> (<em>Iterable</em><em>[</em><a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.Future" title="eqsql.task_queues.core.Future"><em>Future</em></a><em>]</em>) – the futures of the tasks whose priorities are returned.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A List of tuples containing the future and priorty for each task, or ResultStatus.FAILURE
if the query has failed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<em>Tuple</em>[<a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.Future" title="eqsql.task_queues.core.Future"><em>Future</em></a>, int]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eqsql.task_queues.service_queue.ServiceTaskQueue.get_status">
<span class="sig-name descname"><span class="pre">get_status</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">futures</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.get_status" title="Link to this definition">¶</a></dt>
<dd><p>Gets the status (queued, running, etc.) of the specified tasks</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>futures</strong> (<em>Iterable</em><em>[</em><a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.Future" title="eqsql.task_queues.core.Future"><em>Future</em></a><em>]</em>) – the futures of the tasks to get the status of.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A List of Tuples containing the status of the tasks. The first element
of the tuple will be the task id, and the second element will be the
status of that task as a <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskStatus</span></code> object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<em>Tuple</em>[<a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.Future" title="eqsql.task_queues.core.Future"><em>Future</em></a>, <a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.TaskStatus" title="eqsql.task_queues.core.TaskStatus"><em>TaskStatus</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eqsql.task_queues.service_queue.ServiceTaskQueue.get_worker_pools">
<span class="sig-name descname"><span class="pre">get_worker_pools</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">futures</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.get_worker_pools" title="Link to this definition">¶</a></dt>
<dd><p>Gets the worker pools on which the specified list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Futures</span></code> are running, if any.
All the specified <code class="xref py py-class docutils literal notranslate"><span class="pre">Futures</span></code> must have been submitted by the same task queue (i.e., they
are all in the same eqsql database).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of two element tuples. The first element is a <code class="xref py py-class docutils literal notranslate"><span class="pre">Future</span></code>, and the
second is that <code class="xref py py-class docutils literal notranslate"><span class="pre">Futures</span></code>’s worker pool, or None, if the <code class="xref py py-class docutils literal notranslate"><span class="pre">Future</span></code> hasn’t been
selected for execution yet.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>futures</strong> (<em>List</em><em>[</em><a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.Future" title="eqsql.task_queues.core.Future"><em>Future</em></a><em>]</em>)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<em>Tuple</em>[<a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.Future" title="eqsql.task_queues.core.Future"><em>Future</em></a>, str | None]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eqsql.task_queues.service_queue.ServiceTaskQueue.pop_completed">
<span class="sig-name descname"><span class="pre">pop_completed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">futures</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sleep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.pop_completed" title="Link to this definition">¶</a></dt>
<dd><p>Pops and returns the first completed future from the specified List
of Futures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>futures</strong> (<em>List</em><em>[</em><a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.Future" title="eqsql.task_queues.core.Future"><em>Future</em></a><em>]</em>) – the List of <code class="xref py py-class docutils literal notranslate"><span class="pre">Futures</span></code> to check for a completed one. The completed
<code class="xref py py-class docutils literal notranslate"><span class="pre">Future</span></code> will be popped from this list.</p></li>
<li><p><strong>timeout</strong> – a <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeoutError</span></code> will be raised if a completed Future cannot be returned
by after this amount time.</p></li>
<li><p><strong>sleep</strong> (<em>float</em>) – the time, in seconds, to sleep between each iteration over all the Futures,
when looking for a completed one.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The first completed <code class="xref py py-class docutils literal notranslate"><span class="pre">Future</span></code> from the specified List
of <code class="xref py py-class docutils literal notranslate"><span class="pre">Futures</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.Future" title="eqsql.task_queues.core.Future"><em>Future</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eqsql.task_queues.service_queue.ServiceTaskQueue.query_result">
<span class="sig-name descname"><span class="pre">query_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eq_task_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.query_result" title="Link to this definition">¶</a></dt>
<dd><p>Queries for the result of the specified task.</p>
<p>The query repeatedly polls for a result. The polling interval is specified by
the delay such that the first interval is defined by the initial delay value
which is increased after the first poll. The polling will
timeout after the amount of time specified by the timout value is has elapsed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eq_task_id</strong> (<em>int</em>) – the id of the task to query</p></li>
<li><p><strong>delay</strong> (<em>float</em>) – the initial polling delay value</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – the duration after which the query will timeout. If timeout is None, there is no limit to
the wait time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ResultStatus.SUCCESS</span></code> or <code class="docutils literal notranslate"><span class="pre">ResultStatus.FAILURE</span></code>, and whose second element
is either the result of the task, or in the case of failure the reason
for the failure (<code class="docutils literal notranslate"><span class="pre">EQ_TIMEOUT</span></code>, or <code class="docutils literal notranslate"><span class="pre">EQ_ABORT</span></code>)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple whose first element indicates the status of the query</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eqsql.task_queues.service_queue.ServiceTaskQueue.submit_task">
<span class="sig-name descname"><span class="pre">submit_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">payload</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.submit_task" title="Link to this definition">¶</a></dt>
<dd><p>Submits work of the specified type and priority with the specified
payload, returning the <code class="xref py py-class docutils literal notranslate"><span class="pre">status</span></code> and the <code class="xref py py-class docutils literal notranslate"><span class="pre">Future</span></code> encapsulating the submission.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_id</strong> (<em>str</em>) – the id of the experiment of which the work is part.</p></li>
<li><p><strong>eq_type</strong> (<em>int</em>) – the type of work</p></li>
<li><p><strong>payload</strong> (<em>str</em>) – the work payload</p></li>
<li><p><strong>priority</strong> (<em>int</em>) – the priority of this work</p></li>
<li><p><strong>tag</strong> (<em>str</em>) – an optional metadata tag for the task</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the status (<code class="xref py py-class docutils literal notranslate"><span class="pre">ResultStatus.FAILURE</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ResultStatus.SUCCESS</span></code>) of the submission
and if successful, a <code class="xref py py-class docutils literal notranslate"><span class="pre">Future</span></code> representing the submitted task otherwise None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.ResultStatus" title="eqsql.task_queues.core.ResultStatus"><em>ResultStatus</em></a>, <a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.Future" title="eqsql.task_queues.core.Future"><em>Future</em></a> | None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eqsql.task_queues.service_queue.ServiceTaskQueue.submit_tasks">
<span class="sig-name descname"><span class="pre">submit_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">payload</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.submit_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Submits work of the specified type and priority with the specified
payloads, returning the <code class="xref py py-class docutils literal notranslate"><span class="pre">status</span></code> and the <code class="xref py py-class docutils literal notranslate"><span class="pre">futures</span></code>
encapsulating the submission.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_id</strong> (<em>str</em>) – the id of the experiment of which the work is part.</p></li>
<li><p><strong>eq_type</strong> (<em>int</em>) – the type of work</p></li>
<li><p><strong>payload</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – a list of the work payloads</p></li>
<li><p><strong>priority</strong> (<em>int</em>) – the priority of this work</p></li>
<li><p><strong>tag</strong> (<em>str</em>) – an optional metadata tag for the tasks</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the status (<code class="xref py py-class docutils literal notranslate"><span class="pre">ResultStatus.FAILURE</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ResultStatus.SUCCESS</span></code>)
of the submission and the list of <code class="xref py py-class docutils literal notranslate"><span class="pre">futures</span></code> for the submitted tasks. If the submission fails,
the list of <code class="xref py py-class docutils literal notranslate"><span class="pre">futures</span></code> will contain the <code class="xref py py-class docutils literal notranslate"><span class="pre">futures</span></code> that submitted sucessfully.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.ResultStatus" title="eqsql.task_queues.core.ResultStatus"><em>ResultStatus</em></a>, <em>List</em>[<a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.Future" title="eqsql.task_queues.core.Future"><em>Future</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eqsql.task_queues.service_queue.ServiceTaskQueue.update_priorities">
<span class="sig-name descname"><span class="pre">update_priorities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">futures</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_priority</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.update_priorities" title="Link to this definition">¶</a></dt>
<dd><p>Updates the priority of the specified <code class="xref py py-class docutils literal notranslate"><span class="pre">Futures</span></code> to the new_priority.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>futures</strong> (<em>List</em><em>[</em><a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.Future" title="eqsql.task_queues.core.Future"><em>Future</em></a><em>]</em>) – the <code class="xref py py-class docutils literal notranslate"><span class="pre">Futures</span></code> to update.</p></li>
<li><p><strong>new_priority</strong> (<em>int</em><em> | </em><em>List</em><em>[</em><em>int</em><em>]</em>) – the priority to update to. If this is a single integer then
all the specified tasks are updated to that priority. If this is a
List of ints then each task is updated with the corresponding priority, i.e.,
the first task in the <code class="docutils literal notranslate"><span class="pre">futures</span></code> is updated with the first priority in the new_priority
List.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>If the update is successful, the Tuple will contain ResultStatus.SUCCESS and</dt><dd><p>the eq_task_ids of the tasks whose priority was successfully updated,
otherwise (ResultStatus.FAILURE, []).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<a class="reference internal" href="eqsql.task_queues.core.html#eqsql.task_queues.core.ResultStatus" title="eqsql.task_queues.core.ResultStatus"><em>ResultStatus</em></a>, int]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="eqsql.task_queues.service_queue.init_task_queue">
<span class="sig-prename descclassname"><span class="pre">eqsql.task_queues.service_queue.</span></span><span class="sig-name descname"><span class="pre">init_task_queue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">service_url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_host</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_port</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retry_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eqsql.task_queues.service_queue.init_task_queue" title="Link to this definition">¶</a></dt>
<dd><p>Initializes and returns an <code class="xref py py-class docutils literal notranslate"><span class="pre">LocalTaskQueue</span></code> class instance with the specified parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>host</strong> – the eqsql database host</p></li>
<li><p><strong>user</strong> – the eqsql database user</p></li>
<li><p><strong>port</strong> – the eqsql database port</p></li>
<li><p><strong>db_name</strong> (<em>str</em>) – the eqsql database name</p></li>
<li><p><strong>password</strong> (<em>str</em>) – the eqdql database password (if there is one)</p></li>
<li><p><strong>retry_threshold</strong> – if a DB connection cannot be established
(e.g, there are currently too many connections),
then retry <code class="docutils literal notranslate"><span class="pre">retry_threshold</span></code> many times to establish a connection. There
will be random few second delay betwen each retry.</p></li>
<li><p><strong>service_url</strong> (<em>str</em>)</p></li>
<li><p><strong>db_host</strong> (<em>str</em>)</p></li>
<li><p><strong>db_user</strong> (<em>str</em>)</p></li>
<li><p><strong>db_port</strong> (<em>int</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An <a class="reference internal" href="#eqsql.task_queues.service_queue.ServiceTaskQueue" title="eqsql.task_queues.service_queue.ServiceTaskQueue"><code class="xref py py-class docutils literal notranslate"><span class="pre">ServiceTaskQueue</span></code></a> instance</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#eqsql.task_queues.service_queue.ServiceTaskQueue" title="eqsql.task_queues.service_queue.ServiceTaskQueue"><em>ServiceTaskQueue</em></a></p>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">eqsql.task_queues.service_queue module</a><ul>
<li><a class="reference internal" href="#eqsql.task_queues.service_queue.ServiceTaskQueue"><code class="docutils literal notranslate"><span class="pre">ServiceTaskQueue</span></code></a><ul>
<li><a class="reference internal" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.are_queues_empty"><code class="docutils literal notranslate"><span class="pre">ServiceTaskQueue.are_queues_empty()</span></code></a></li>
<li><a class="reference internal" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.as_completed"><code class="docutils literal notranslate"><span class="pre">ServiceTaskQueue.as_completed()</span></code></a></li>
<li><a class="reference internal" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.cancel_tasks"><code class="docutils literal notranslate"><span class="pre">ServiceTaskQueue.cancel_tasks()</span></code></a></li>
<li><a class="reference internal" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.get_priorities"><code class="docutils literal notranslate"><span class="pre">ServiceTaskQueue.get_priorities()</span></code></a></li>
<li><a class="reference internal" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.get_status"><code class="docutils literal notranslate"><span class="pre">ServiceTaskQueue.get_status()</span></code></a></li>
<li><a class="reference internal" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.get_worker_pools"><code class="docutils literal notranslate"><span class="pre">ServiceTaskQueue.get_worker_pools()</span></code></a></li>
<li><a class="reference internal" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.pop_completed"><code class="docutils literal notranslate"><span class="pre">ServiceTaskQueue.pop_completed()</span></code></a></li>
<li><a class="reference internal" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.query_result"><code class="docutils literal notranslate"><span class="pre">ServiceTaskQueue.query_result()</span></code></a></li>
<li><a class="reference internal" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.submit_task"><code class="docutils literal notranslate"><span class="pre">ServiceTaskQueue.submit_task()</span></code></a></li>
<li><a class="reference internal" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.submit_tasks"><code class="docutils literal notranslate"><span class="pre">ServiceTaskQueue.submit_tasks()</span></code></a></li>
<li><a class="reference internal" href="#eqsql.task_queues.service_queue.ServiceTaskQueue.update_priorities"><code class="docutils literal notranslate"><span class="pre">ServiceTaskQueue.update_priorities()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#eqsql.task_queues.service_queue.init_task_queue"><code class="docutils literal notranslate"><span class="pre">init_task_queue()</span></code></a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="eqsql.task_queues.gc_queue.html"
                          title="previous chapter">eqsql.task_queues.gc_queue module</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="eqsql.task_queues.emews_service.html"
                          title="next chapter">eqsql.task_queues.emews_service module</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/eqsql.task_queues.service_queue.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="eqsql.task_queues.emews_service.html" title="eqsql.task_queues.emews_service module"
             >next</a> |</li>
        <li class="right" >
          <a href="eqsql.task_queues.gc_queue.html" title="eqsql.task_queues.gc_queue module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">EQ-SQL  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="eqsql.html" >eqsql package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">eqsql.task_queues.service_queue module</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2023, UChicago Argonne, LLC.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.1.0.
    </div>
  </body>
</html>